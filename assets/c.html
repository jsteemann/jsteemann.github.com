<html>
<head>
  <title>converter</title>
  <script type="text/javascript">
function wrapIt (value) {
  if (value) {
    document.getElementById('value').wrap = 'on';
  }
  else {
    document.getElementById('value').wrap = 'off';
  }
}

function convert () {
  var src = document.getElementById('value').value;
  var delim = { "\t" : 0, ";" : 0 };
  var isEmpty = true;
  var lines = 0;
  var isWindows = false;

  for (var i = 0; i < src.length; ++i) {
    var c = src.charAt(i);

    if (c == "\t" || c == ";") {
      delim[c]++;
    }
    else if (c == "\r") {
      isWindows = true;
    }
    else if (c == "\n") {
      lines++;
    }
    else if (c != " ") {
      isEmpty = false;
    }
  }

  if (isEmpty) {
    returm;
  }

  src = src.replace(/^\s+/, "");
  src = src.replace(/s+$/, "");

  var nl = (isWindows ? "\r\n" : "\n");
  var delimiter = ((delim["\t"] > delim[";"]) ? "\t" : ";");
  var lines = src.split(nl);
  var columns = lines[0].split(delimiter);
  
  var index = -1;
  for (var i = 0; i < columns.length; ++i) {
    var column = columns[i].toLowerCase().replace(/"/g, "");
    if (column == "abweichungstyp") {
      index = i;
    }
  }

  var result = ""; 
  for (var i = 0; i < lines.length; ++i) {
    var values = lines[i].split(delimiter);
    if (i > 0 && index >= 0 && values[index] == "") {
      values[index] = "manuell";
    }
    result += values.join("\t") + nl; 
  }

  document.getElementById('value').value = result;
}
  </script>
</head>
<body>
  <form onsubmit="return false;">
    <textarea id="value" style="width:100%; height:400px;" onclick="if (this.value == 'Paste values here...') { this.value = ''; }">Paste values here...</textarea>
    <br /><br />
    Wrap lines: 
    <br />
    <input type="radio" name="wrap" value="no" onclick="wrapIt(false);" /> No
    <br />
    <input type="radio" name="wrap" value="yes" onclick="wrapIt(true);" /> Yes
    <br /><br />
    <input type="submit" value="convert" onclick="convert();return false;" />
  </form>
</body>
</html>
